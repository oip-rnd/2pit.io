<!-- 
/**
 * PpitCore V1.0 (https://github.com/p-pit/PpitCore)
 *
 * @link      https://github.com/p-pit/PpitCore
 * @copyright Copyright (c) 2016 Bruno Lartillot
 * @license   https://github.com/p-pit/PpitCore/blob/master/license.txt GNU-GPL license
 */
-->

<?php
$title = 'P-PIT';
$this->headTitle($title);
echo $this->partial('/partials/header');
?>
<div>&nbsp;</div>
<div class="row">
    <div class="col-md-6 col-md-offset-3">

		<div class="panel panel-default">
            <div class="panel-heading" style="background: <?php echo $context->getConfig('styleSheet')['panelHeadingBackground'] ?>; color: <?php echo $context->getConfig('styleSheet')['panelHeadingColor'] ?>">
				<strong><?php echo $this->translate('Lost password', 'ppit-core', $locale) ?></strong>
			</div>
           	<div class="panel-body">

<!-- Load the form header -->
<?php echo $this->partial('/partials/form-header.phtml', array(
			'update_time' => '',
			'message' => $message,
			'error' => $error,
			'csrfForm' => $csrfForm,
			'context' => $context,
)); ?>

			<div id="message">
				<div class="alert alert-warning">
					<?php echo $this->translate('An email will be sent at your address, allowing you to define a new password.', 'ppit-core', $context->getLocale()) ?><br>
					<strong><?php echo sprintf($this->translate('Please note that this email has a validity of %s days.', 'ppit-core', $context->getLocale()), $config['ppitUserSettings']['tokenValidity']) ?></strong>
				</div>
			</div>

<?php if ($message == 'OK') $isDisabled = true; else $isDisabled = false; ?>

<?php if ($message == 'OK') : ?>

<!-- Login anchor -->
		    <div class="form-group">
				<div class="col-sm-4">&nbsp;</div>
				<div class="col-sm-8">
					<a href="<?php echo $this->url('user/login') ?>"><?php echo $this->translate('Login', 'ppit-core', $context->getLocale()) ?></a>
				</div>
			</div>

<?php else : ?>

<!-- Identifier -->
			<div class="form-group" id="username_group">
				<label class="col-sm-5 control-label"><?php echo $this->translate('Identifier', 'ppit-core', $context->getLocale()) ?></label>
				<div class="col-sm-7">
					<input name="username" id="username" class="form-control" placeholder="<?php echo $this->translate('Please input your identifier', 'ppit-core', $context->getLocale()) ?>" <?php if (isset($isDisabled) && $isDisabled) echo 'disabled ="disabled"' ?>>
				</div>
				<div class="col-sm-12"><p class="help-block" id="username_error"></p></div>
			</div>

<?php endif ?>

<?php if (!$message) : ?>
<!-- Submit button -->
		    <div class="form-group">
				<div class="col-sm-5">&nbsp;</div>
				<div class="col-sm-7">
					<input name="submit" type="submit" id="submit-button" class="btn btn-warning" value="<?php echo $this->translate('Confirm', 'ppit-core', $context->getLocale()) ?>">
					&nbsp;&nbsp;
					<a href="<?php echo $this->url('user/login', array('instance_caption' => $context->getInstance()->caption)) ?>"><?php echo $this->translate('Cancel', 'ppit-core', $context->getLocale()) ?></a>
				</div>
			</div>
<?php endif;?>
		</form>
	</div>
</div>
	</div>
</div>
